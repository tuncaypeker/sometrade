//@version=5
indicator(title="Serkan Average", shorttitle="SERKA", overlay=true, timeframe="", timeframe_gaps=true)

length = input(title="Length", defval=14)
fastLength = input(title="Fast EMA Length", defval=2)
slowLength = input(title="Slow EMA Length", defval=30)
highlightMovements = input(title="Highlight Movements ?", defval=true)
src = input(title="Source", defval=close)

changex = ta.change(src, length)
mom = math.abs(changex)



volatility = math.sum(math.abs(ta.change(src)), length)


// Efficiency Ratio
er = volatility != 0 ? mom / volatility : 0


fastAlpha = 2 / (fastLength + 1)
slowAlpha = 2 / (slowLength + 1)



// KAMA Alpha
sc = math.pow((er * (fastAlpha - slowAlpha)) + slowAlpha, 2)


kama = 0.0
kama := sc * src + (1 - sc) * nz(kama[1])

kamaColor = highlightMovements ? (kama > kama[1] ? color.green : color.red) : #6d1e7f
plot(kama, title="KAMA", linewidth=2, color=kamaColor, transp=0)
